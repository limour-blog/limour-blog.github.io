---
title: 【迁移】从ENI数据库下载fastq文件
urlname: cong-ENI-shu-ju-ku-xia-zai-fastq-wen-jian
date: 2022-09-25 19:32:17
tags: ['ENI', 'NCBI-GEO', 'fastq', 'SRA']
---
## 从ENI数据库下载fastq文件
进入[ENA Browser](https://www.ebi.ac.uk/ena/browser/view/PRJNA573608?show=reads)，搜索对应的GSE号，进入study项目，选择TSV格式的**Download report**。

![](https://img.limour.top/2023/09/01/64f1ccc8a3734.webp)

从TSV表格中提取下载链接，一行一个写入url.txt，前面加上`ftp://`，接着使用`wget -c -i url.txt`下载

批量重命名脚本：

```bash
ls *.fastq.gzcut -d '_' -f 1while read i ;do (echo ${i}_1*.gz' will be moved to '${i}_S1_L001_R1_001.fastq.gz);done
ls *.fastq.gzcut -d '_' -f 1while read i ;do (echo ${i}_2*.gz' will be moved to '${i}_S1_L001_R2_001.fastq.gz);done
 
ls *.fastq.gzcut -d '_' -f 1while read i ;do (mv ${i}_1*.gz ${i}_S1_L001_R1_001.fastq.gz;mv ${i}_2*.gz ${i}_S1_L001_R2_001.fastq.gz);done
```

## NCBI-GEO：SRA文件转FASTQ文件

### 安装依赖
```bash
conda create -n sra_tools -c bioconda sra-tools
conda activate sra_tools
conda install -c conda-forge pigz -y
prefetch
```

### 批量下载SRA文件

*   mkdir upload/zl\_liu/sra/GSE172205
*   cd upload/zl\_liu/sra/GSE172205
*   通过 https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=<GSE\_ID> 得到 <SRP\_ID>
*   通过 https://www.ncbi.nlm.nih.gov/Traces/study/?acc=<SRP\_ID> 搜索 <SRP\_ID>
*   下载 **Total** 的 **Accession List**，上传到 upload/zl\_liu/sra/GSE172205 目录下
*    vdb-config -i 设置http代理，网络好也可以不设置
*   prefetch --option-file SRR\_Acc\_List.txt

### 批量转换为FASTQ文件

```sh
#!/bin/sh
#任务名
TASKN=GSE172205
#设置根目录
ROOTDIR=/home/jovyan/upload/zl_liu/sra/GSE172205
#设置CleanData存放目录
CLEAN=$ROOTDIR/$TASKN
 
mkdir $CLEAN
for  file in `cat SRR_Acc_List.txt`
do
echo $file
mkdir $CLEAN/$file
cd $CLEAN/$file
fasterq-dump --split-3 $ROOTDIR/$file -e 16
pigz -p 16 *
done
```

*   nano 11.sh
*   chmod +x 11.sh
*   ./11.sh

## 后续分析
[STAR：一键脚本](/STAR--yi-jian-jiao-ben)