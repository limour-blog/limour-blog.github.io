---
title: 【学习】使用GATK4.0找SNP
urlname: shi-yong-GATK-zhao-SNP
date: 2023-09-24 18:49:18
tags: ['GATK', 'SNP', 'WGS']
---
## 配置环境
+ [基础编程环境](/-ji-lu--an-zhuang-sheng-xin-de-dai-ma-bian-xie-huan-jing)
+ [GitHub 下载加速](/-fu-ke-GitHub-wen-jian-jia-su)
+ [可能需要用到的加速服务](/-ji-lu-SOCKS5-zhuan-QUIC)
### SRA工具
```bash
conda create -n sra_tools -c bioconda sra-tools
conda activate sra_tools
conda install -c conda-forge pigz -y
prefetch
# vdb-config -i # 设置 HTTP 代理
```
### GATK4
```bash
conda create -n GATK4 -c bioconda gatk4
conda activate GATK4
conda install -c bioconda samtools -y
conda install -c bioconda bwa -y
```
+ BWA是DNA比对工具(不会跨外显子比对)，[STAR](/STAR--yi-jian-jiao-ben)是RNA比对工具
+ [找SNP不推荐用RNAseq的数据](https://zhuanlan.zhihu.com/p/37345954)
+ [各种比对工具的说明](https://www.jianshu.com/p/601469194b5e)
## 准备数据
### 参考数据
+ [NCBI上各物种的参考序列](https://www.ncbi.nlm.nih.gov/genome/browse)，可以找到RefSeq，比如Human是GCF_000001405
+ 知道序号后可以到[FTP](https://ftp.ncbi.nlm.nih.gov/genomes/all/GCF/)上下载相应的`genomic.fna.gz`文件
+ 比如GCF_000001405，依次进入`000/001/405`即可找到对应的文件
```bash
wget https://ftp.ncbi.nlm.nih.gov/genomes/all/GCF/000/001/405/GCF_000001405.40_GRCh38.p14/GCF_000001405.40_GRCh38.p14_genomic.fna.gz -O GRCh38.p14.fna.gz
conda run -n sra_tools pigz -d GRCh38.p14.fna.gz # 得到 GRCh38.p14.fna
# 创建索引
samtools faidx GRCh38.p14.fna # 得到 GRCh38.p14.fna.fai
# 查看一段序列
samtools faidx GRCh38.p14.fna NC_000001.11:1000000-1000200
# 创建比对索引
bwa index GRCh38.p14.fna # 会自动在 bwtsw, is or rb2 三种算法中选择合适的
```
### 测序数据
+ WGS的DNA测序数据
+ 以[SRX247249](https://www.ncbi.nlm.nih.gov/sra/SRX247249)做学习的示例数据，感谢[曾老师](http://www.biotrainee.com/thread-1376-1-1.html)指路
+ 下载方式见[SRA文件转FASTQ文件](/cong-ENI-shu-ju-ku-xia-zai-fastq-wen-jian#NCBI-GEO%EF%BC%9ASRA%E6%96%87%E4%BB%B6%E8%BD%ACFASTQ%E6%96%87%E4%BB%B6)
+ 也可以到[ENA数据库](https://www.ebi.ac.uk/ena/browser/view/SRX247249)上下载
```bash
conda run -n sra_tools prefetch --option-file SRR_Acc_List.txt
```

未完待续... ...